generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Course {
  courseId      String   @id @default(uuid()) @db.Uuid
  courseName    String
  courseCreator String
  createdAt     DateTime @default(now()) @db.Timestamptz()
  updatedAt     DateTime @updatedAt @db.Timestamptz()
  createdBy     String
  updatedBy     String

  versions  CourseVersion[]
  questions CourseQuestion[]
}

model CourseQuestion {
  courseQuestionId String @id @default(uuid()) @db.Uuid
  courseId         String @db.Uuid
  questionId       String @db.Uuid
  courseVersionId  String @db.Uuid

  course        Course        @relation(fields: [courseId], references: [courseId])
  question      Question      @relation(fields: [questionId], references: [questionId])
  courseVersion CourseVersion @relation(fields: [courseVersionId], references: [courseVersionId])
}

model Question {
  questionId       String       @id @default(uuid()) @db.Uuid
  questionSentence String
  answer           String
  options          String?
  questionType     QuestionType

  courseQuestions CourseQuestion[]
}

enum QuestionType {
  TRUE_FALSE
  MULTI_SELECT
  SHORT_ANSWER
}

model CourseVersion {
  courseVersionId String @id @default(uuid()) @db.Uuid
  courseId        String @db.Uuid
  version         Int

  course    Course           @relation(fields: [courseId], references: [courseId])
  questions CourseQuestion[]

  @@unique([courseId, version])
}
